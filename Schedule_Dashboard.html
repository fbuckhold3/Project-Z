<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Residency Scheduling Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.27.0/plotly.min.js"></script>
    <style>
        :root {
            --primary-blue: #1e3a8a;
            --primary-light: #3b82f6;
            --secondary-blue: #60a5fa;
            --border-gray: #e5e7eb;
            --text-dark: #1f2937;
            --text-light: #6b7280;
            --bg-light: #f9fafb;
            --color-sluh: #B3D9FF;
            --color-va: #FFCC99;
            --color-nf: #D9B3FF;
            --color-micu: #FFB3B3;
            --color-cards: #FFFFB3;
            --color-op: #B3FFB3;
            --color-clinic: #FFFFFF;
            --color-jeopardy: #FFE0B2;
            --color-id: #C8E6C9;
            --color-bronze: #FFE0B2;
            --color-diamond: #E1BEE7;
            --color-gold: #FFF9C4;
            --color-icu: #FFD9D9;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
        }
        .header {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            color: white;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
        }
        .header h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        .level-toggle {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        .level-btn {
            padding: 0.75rem 1.5rem;
            border: 2px solid white;
            background: transparent;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .level-btn:hover {
            background: rgba(255,255,255,0.2);
        }
        .level-btn.active {
            background: white;
            color: var(--primary-blue);
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--border-gray);
            flex-wrap: wrap;
        }
        .tab-btn {
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            color: var(--text-light);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        .tab-btn:hover {
            color: var(--primary-blue);
        }
        .tab-btn.active {
            color: var(--primary-blue);
            border-bottom-color: var(--primary-blue);
        }
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        .tab-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .kpi-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .kpi-card {
            background: white;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .kpi-label {
            color: var(--text-light);
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .kpi-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-blue);
        }
        .color-legend {
            background: white;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }
        .legend-color {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            border: 1px solid #999;
        }
        .schedule-grid {
            background: white;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            overflow: auto;
            margin-bottom: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .grid-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }
        .grid-table th {
            background: var(--bg-light);
            border: 1px solid var(--border-gray);
            padding: 0.5rem;
            font-weight: 600;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .grid-table td {
            border: 1px solid var(--border-gray);
            padding: 0.5rem;
            text-align: center;
            height: 30px;
            vertical-align: middle;
            font-weight: 500;
        }
        .grid-table th:first-child,
        .grid-table td:first-child {
            position: sticky;
            left: 0;
            z-index: 9;
            background: white;
            min-width: 120px;
            text-align: left;
        }
        .grid-table th:first-child {
            background: var(--bg-light);
            z-index: 11;
        }
        .rotation-cell {
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: default;
        }
        .coverage-row {
            background: var(--bg-light);
            font-weight: 600;
        }
        .coverage-cell {
            padding: 0.75rem !important;
            height: auto !important;
            font-size: 0.8rem !important;
        }
        .coverage-cell.meets-target {
            background: #d1fae5 !important;
            color: #065f46;
        }
        .coverage-cell.below-target {
            background: #fee2e2 !important;
            color: #7f1d1d;
        }
        .rotator-section-header {
            background: #f0f0f0;
            font-weight: 700;
            padding: 0.75rem !important;
            text-align: left !important;
        }
        .summary-cell {
            background: #f9fafb;
            font-weight: 600;
        }
        .dropdown-group {
            background: white;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        .dropdown-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-dark);
        }
        .dropdown-group select {
            width: 100%;
            max-width: 400px;
            padding: 0.75rem;
            border: 1px solid var(--border-gray);
            border-radius: 4px;
            font-size: 1rem;
            background: white;
        }
        .timeline-bar {
            width: 100%;
            height: 40px;
            display: flex;
            border-radius: 4px;
            overflow: hidden;
            border: 2px solid var(--border-gray);
            margin: 1rem 0;
        }
        .timeline-segment {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65rem;
            font-weight: 600;
            color: #333;
            border-right: 1px solid rgba(0,0,0,0.1);
        }
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
            background: white;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 1.5rem;
        }
        .stat-item {
            text-align: center;
        }
        .stat-label {
            color: var(--text-light);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            font-weight: 500;
        }
        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary-blue);
        }
        .chart-container {
            background: white;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .chart-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-dark);
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            overflow: hidden;
        }
        .comparison-table th {
            background: var(--bg-light);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid var(--border-gray);
            cursor: pointer;
            user-select: none;
        }
        .comparison-table th:hover {
            background: #e5e7eb;
        }
        .comparison-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-gray);
        }
        .comparison-table tr:hover {
            background: var(--bg-light);
        }
        .outlier-badge {
            display: inline-block;
            background: #fee2e2;
            color: #7f1d1d;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .outlier-badge.high {
            background: #fecaca;
        }
        .percentile-bar {
            width: 100%;
            height: 20px;
            background: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        .percentile-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
            transition: width 0.3s ease;
        }
        .heatmap-container {
            overflow: auto;
            background: white;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        .stackbar-container {
            background: white;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        .staffing-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            overflow: hidden;
            margin-top: 1.5rem;
        }
        .staffing-table th,
        .staffing-table td {
            padding: 0.75rem;
            border: 1px solid var(--border-gray);
            text-align: center;
            font-size: 0.85rem;
        }
        .staffing-table th {
            background: var(--bg-light);
            font-weight: 600;
        }
        .staffing-table td:first-child {
            text-align: left;
            font-weight: 600;
        }
        .histogram-container,
        .boxplot-container {
            background: white;
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        @media (max-width: 768px) {
            .header { padding: 1.5rem 1rem; }
            .header h1 { font-size: 1.5rem; }
            .level-toggle { gap: 0.5rem; }
            .level-btn { padding: 0.5rem 1rem; font-size: 0.9rem; }
            .kpi-row { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
            .grid-table { font-size: 0.75rem; }
            .grid-table td { padding: 0.25rem; height: 24px; }
            .tabs { overflow-x: auto; }
            .tab-btn { padding: 0.75rem 1rem; font-size: 0.9rem; white-space: nowrap; }
            .stat-grid { grid-template-columns: repeat(2, 1fr); }
            .comparison-table { font-size: 0.85rem; }
            .comparison-table th, .comparison-table td { padding: 0.5rem; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Residency Scheduling Dashboard</h1>
        <div class="level-toggle">
            <button class="level-btn active" onclick="switchLevel('senior')">Senior (PGY-2/3)</button>
            <button class="level-btn" onclick="switchLevel('intern')">Intern (PGY-1)</button>
        </div>
    </div>

    <div class="container">
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab(0)">Schedule Grid</button>
            <button class="tab-btn" onclick="switchTab(1)">Resident Deep Dive</button>
            <button class="tab-btn" onclick="switchTab(2)">Weekly Staffing</button>
            <button class="tab-btn" onclick="switchTab(3)">Balance & Fairness</button>
        </div>

        <div id="tab-0" class="tab-content active">
            <div id="schedule-kpi"></div>
            <div id="schedule-legend"></div>
            <div class="schedule-grid">
                <table id="schedule-table" class="grid-table"></table>
            </div>
        </div>

        <div id="tab-1" class="tab-content">
            <div class="dropdown-group">
                <label for="resident-select">Select Resident:</label>
                <select id="resident-select" onchange="updateDeepDive()"></select>
            </div>
            <div id="deepdive-timeline"></div>
            <div id="deepdive-stats"></div>
            <div id="deepdive-chart"></div>
            <div id="deepdive-percentile"></div>
        </div>

        <div id="tab-2" class="tab-content">
            <div id="staffing-heatmap" class="heatmap-container"></div>
            <div id="staffing-stackbar" class="stackbar-container" style="display:none;"></div>
            <div id="staffing-table-container"></div>
        </div>

        <div id="tab-3" class="tab-content">
            <div id="fairness-histogram" class="histogram-container"></div>
            <div id="fairness-boxplot" class="boxplot-container"></div>
            <div id="fairness-outliers"></div>
        </div>
    </div>

    <script>
        const RAW = {"senior":{"targets":{"SLUH":6,"VA":5,"ID":1,"NF":5,"MICU":4,"Bronze":2,"Cards":2,"Diamond":1,"Gold":1,"Jeopardy":1},"residents":[{"id":"R3_01","pgy":3,"pos":4,"type":"PGY3","schedule":["Gold","OP","Cards","Clinic","OP","OP","NF","NF","OP","Clinic","OP","MICU","Diamond","OP","OP","Clinic","Bronze","OP","SLUH","SLUH","SLUH","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","OP","OP","OP","OP","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","MICU","OP","VA","VA","VA","Clinic","NF","NF"],"counts":{"Gold":1,"OP":17,"Cards":1,"Clinic":8,"NF":4,"MICU":3,"Diamond":1,"Bronze":1,"SLUH":6,"VA":6},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R3_02","pgy":3,"pos":3,"type":"PGY3","schedule":["NF","NF","Clinic","MICU","OP","Bronze","Jeopardy","Cards","Clinic","Diamond","OP","Gold","MICU","OP","Clinic","OP","OP","OP","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","VA","VA","VA","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","Bronze","Clinic","OP","NF","NF","MICU","OP","Clinic","Cards","OP","OP"],"counts":{"NF":4,"Clinic":8,"MICU":4,"OP":16,"Bronze":2,"Jeopardy":1,"Cards":2,"Diamond":1,"Gold":1,"SLUH":6,"VA":3},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R3_03","pgy":3,"pos":6,"type":"PGY3","schedule":["ID","ID","ID","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","OP","OP","NF","NF","OP","Clinic","VA","VA","VA","OP","MICU","Clinic","Bronze","Gold","Cards","OP","Jeopardy","Clinic","OP","OP","OP","Diamond","OP","Clinic","SLUH","SLUH","SLUH","OP","Bronze","Clinic","NF","NF","MICU","OP","OP","Clinic"],"counts":{"ID":3,"OP":15,"Clinic":8,"SLUH":6,"MICU":3,"NF":4,"VA":3,"Bronze":2,"Gold":1,"Cards":1,"Jeopardy":1,"Diamond":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_04","pgy":3,"pos":2,"type":"PGY3","schedule":["OP","Clinic","Jeopardy","SLUH","SLUH","SLUH","OP","Clinic","MICU","OP","NF","NF","OP","Clinic","OP","ID","ID","ID","OP","Clinic","Diamond","MICU","OP","Bronze","OP","Clinic","OP","VA","VA","VA","OP","Clinic","NF","NF","OP","MICU","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","Cards","Gold","Bronze","OP"],"counts":{"OP":15,"Clinic":8,"Jeopardy":1,"SLUH":6,"MICU":3,"NF":4,"ID":3,"Diamond":1,"Bronze":2,"VA":3,"Cards":1,"Gold":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_05","pgy":3,"pos":2,"type":"PGY3","schedule":["Diamond","Clinic","OP","VA","VA","VA","OP","Clinic","NF","NF","MICU","OP","Cards","Clinic","OP","Bronze","OP","OP","MICU","Clinic","OP","Gold","OP","OP","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","NF","NF","MICU","OP","OP","Clinic","OP","VA","VA","VA","OP","Clinic","NF","NF","OP","MICU"],"counts":{"Diamond":1,"Clinic":8,"OP":17,"VA":6,"NF":6,"MICU":4,"Cards":1,"Bronze":1,"Gold":1,"SLUH":3},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R3_06","pgy":3,"pos":3,"type":"PGY3","schedule":["OP","OP","Clinic","OP","OP","OP","OP","OP","Clinic","VA","VA","VA","OP","MICU","Clinic","OP","NF","NF","Cards","OP","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","ID","ID","ID","OP","Bronze","Clinic","MICU","NF","NF","OP","OP","Clinic","VA","VA","VA","Jeopardy","Diamond","Clinic","Bronze","OP","Gold"],"counts":{"OP":15,"Clinic":8,"VA":6,"MICU":3,"NF":4,"Cards":1,"SLUH":3,"ID":3,"Bronze":2,"Jeopardy":1,"Diamond":1,"Gold":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_07","pgy":3,"pos":6,"type":"PGY3","schedule":["VA","VA","VA","OP","MICU","Clinic","NF","NF","OP","Cards","Jeopardy","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","MICU","OP","NF","NF","OP","Clinic","Diamond","Bronze","OP","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","Bronze","OP","Gold","OP","OP","Clinic","NF","NF","MICU","OP","OP","Clinic"],"counts":{"VA":3,"OP":15,"MICU":4,"Clinic":8,"NF":6,"Cards":1,"Jeopardy":1,"SLUH":6,"Diamond":1,"Bronze":2,"Gold":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_08","pgy":3,"pos":6,"type":"PGY3","schedule":["VA","VA","VA","OP","OP","Clinic","MICU","OP","OP","OP","OP","Clinic","NF","NF","Bronze","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","Cards","Clinic","MICU","Jeopardy","OP","Bronze","Diamond","Clinic","VA","VA","VA","OP","OP","Clinic","NF","NF","MICU","OP","OP","Clinic","ID","ID","ID","OP","OP","Clinic"],"counts":{"VA":6,"OP":16,"Clinic":8,"MICU":3,"NF":4,"Bronze":2,"SLUH":3,"Cards":1,"Jeopardy":1,"Diamond":1,"ID":3},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R3_09","pgy":3,"pos":4,"type":"PGY3","schedule":["SLUH","SLUH","SLUH","Clinic","OP","Cards","OP","Diamond","OP","Clinic","OP","OP","VA","VA","VA","Clinic","NF","NF","MICU","OP","MICU","Clinic","Bronze","Gold","OP","OP","OP","Clinic","OP","OP","OP","OP","OP","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","OP","SLUH","SLUH","SLUH","Clinic","NF","NF"],"counts":{"SLUH":6,"Clinic":8,"OP":17,"Cards":1,"Diamond":1,"VA":6,"NF":4,"MICU":3,"Bronze":1,"Gold":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R3_10","pgy":3,"pos":3,"type":"PGY3","schedule":["NF","NF","Clinic","MICU","Jeopardy","Bronze","Diamond","OP","Clinic","MICU","OP","Cards","Gold","OP","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","Cards","OP","OP","NF","NF","Clinic","MICU","OP","OP","OP","OP","Clinic","VA","VA","VA","OP","Bronze","Clinic","Gold","OP","MICU","OP","OP","Clinic","SLUH","SLUH","SLUH"],"counts":{"NF":4,"Clinic":8,"MICU":4,"Jeopardy":1,"Bronze":2,"Diamond":1,"OP":15,"Cards":2,"Gold":2,"SLUH":6,"VA":3},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_11","pgy":3,"pos":1,"type":"PGY3","schedule":["Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","MICU","NF","NF","OP","Bronze","Clinic","OP","OP","Cards","OP","OP","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","NF","NF","OP","Gold","Clinic","MICU","Diamond","Cards","OP","OP","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","NF","NF","Jeopardy","MICU"],"counts":{"Clinic":8,"OP":15,"SLUH":6,"MICU":4,"NF":6,"Bronze":1,"Cards":2,"VA":3,"Gold":1,"Diamond":1,"Jeopardy":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_12","pgy":3,"pos":4,"type":"PGY3","schedule":["SLUH","SLUH","SLUH","Clinic","MICU","OP","VA","VA","VA","Clinic","NF","NF","OP","Jeopardy","Cards","Clinic","OP","OP","NF","NF","MICU","Clinic","OP","OP","Bronze","OP","OP","Clinic","OP","Cards","Diamond","OP","MICU","Clinic","OP","OP","VA","VA","VA","Clinic","Gold","OP","NF","NF","OP","Clinic","MICU","OP"],"counts":{"SLUH":3,"Clinic":8,"MICU":4,"OP":15,"VA":6,"NF":6,"Jeopardy":1,"Cards":2,"Bronze":1,"Diamond":1,"Gold":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_13","pgy":3,"pos":5,"type":"PGY3","schedule":["SLUH","SLUH","SLUH","OP","Clinic","OP","VA","VA","VA","OP","Clinic","MICU","NF","NF","OP","MICU","Clinic","Bronze","Diamond","Cards","OP","OP","Clinic","OP","NF","NF","OP","OP","Clinic","MICU","Gold","OP","OP","OP","Clinic","Jeopardy","VA","VA","VA","OP","Clinic","OP","MICU","OP","NF","NF","Clinic","Bronze"],"counts":{"SLUH":3,"OP":15,"Clinic":8,"VA":6,"MICU":4,"NF":6,"Bronze":2,"Diamond":1,"Cards":1,"Gold":1,"Jeopardy":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_14","pgy":3,"pos":5,"type":"PGY3","schedule":["VA","VA","VA","OP","Clinic","OP","ID","ID","ID","OP","Clinic","Jeopardy","SLUH","SLUH","SLUH","OP","Clinic","MICU","NF","NF","OP","MICU","Clinic","Bronze","OP","Cards","OP","OP","Clinic","OP","VA","VA","VA","OP","Clinic","Diamond","MICU","OP","NF","NF","Clinic","OP","Gold","Bronze","OP","Cards","Clinic","OP"],"counts":{"VA":6,"OP":14,"Clinic":8,"ID":3,"Jeopardy":1,"SLUH":3,"MICU":3,"NF":4,"Bronze":2,"Cards":2,"Diamond":1,"Gold":1},"ip":25,"op":15,"clinic":8,"maxConsec":3},{"id":"R3_15","pgy":3,"pos":4,"type":"PGY3","schedule":["NF","NF","MICU","Clinic","Cards","Diamond","OP","Bronze","OP","Clinic","Gold","OP","VA","VA","VA","Clinic","MICU","OP","OP","OP","OP","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","MICU","NF","NF","Jeopardy","Clinic","Bronze","OP","Cards","OP","OP","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","MICU","OP"],"counts":{"NF":4,"MICU":4,"Clinic":8,"Cards":2,"Diamond":1,"OP":16,"Bronze":2,"Gold":1,"VA":3,"SLUH":6,"Jeopardy":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R3_16","pgy":3,"pos":6,"type":"PGY3","schedule":["Cards","OP","OP","OP","OP","Clinic","NF","NF","MICU","OP","OP","Clinic","OP","OP","OP","Jeopardy","Bronze","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","VA","VA","VA","OP","Gold","Clinic","NF","NF","MICU","OP","Cards","Clinic","VA","VA","VA","OP","Diamond","Clinic"],"counts":{"Cards":2,"OP":15,"Clinic":8,"NF":4,"MICU":3,"Jeopardy":1,"Bronze":1,"SLUH":6,"VA":6,"Gold":1,"Diamond":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_17","pgy":3,"pos":1,"type":"PGY3","schedule":["Clinic","Bronze","OP","VA","VA","VA","Clinic","MICU","NF","NF","OP","Cards","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","MICU","OP","OP","NF","NF","Clinic","OP","Gold","Bronze","OP","Cards","Clinic","Diamond","MICU","OP","OP","OP","Clinic","OP","NF","NF","OP","OP","Clinic","Jeopardy","OP","VA","VA","VA"],"counts":{"Clinic":8,"Bronze":2,"OP":15,"VA":6,"MICU":3,"NF":6,"Cards":2,"SLUH":3,"Gold":1,"Diamond":1,"Jeopardy":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_18","pgy":3,"pos":3,"type":"PGY3","schedule":["OP","Cards","Clinic","MICU","NF","NF","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","Bronze","Clinic","VA","VA","VA","Jeopardy","MICU","Clinic","OP","NF","NF","OP","OP","Clinic","OP","OP","OP","MICU","Gold","Clinic","SLUH","SLUH","SLUH","OP","Diamond","Clinic","Cards","OP","OP","OP","OP","Clinic","MICU","NF","NF"],"counts":{"OP":15,"Cards":2,"Clinic":8,"MICU":4,"NF":6,"SLUH":6,"Bronze":1,"VA":3,"Jeopardy":1,"Gold":1,"Diamond":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_19","pgy":3,"pos":6,"type":"PGY3","schedule":["OP","Jeopardy","NF","NF","MICU","Clinic","Cards","OP","OP","Bronze","OP","Clinic","OP","OP","OP","OP","OP","Clinic","VA","VA","VA","OP","MICU","Clinic","SLUH","SLUH","SLUH","OP","Bronze","Clinic","NF","NF","OP","MICU","Diamond","Clinic","OP","OP","NF","NF","Cards","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic"],"counts":{"OP":16,"Jeopardy":1,"NF":6,"MICU":3,"Clinic":8,"Cards":2,"Bronze":2,"VA":3,"SLUH":6,"Diamond":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R3_20","pgy":3,"pos":1,"type":"PGY3","schedule":["Clinic","MICU","OP","VA","VA","VA","Clinic","OP","NF","NF","Bronze","OP","Clinic","MICU","Diamond","Cards","OP","OP","Clinic","Gold","Jeopardy","SLUH","SLUH","SLUH","Clinic","OP","MICU","OP","NF","NF","Clinic","Cards","OP","Bronze","OP","OP","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","OP","OP","OP","OP"],"counts":{"Clinic":8,"MICU":4,"OP":16,"VA":6,"NF":4,"Bronze":2,"Diamond":1,"Cards":2,"Gold":1,"Jeopardy":1,"SLUH":3},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R3_21","pgy":3,"pos":4,"type":"PGY3","schedule":["OP","Cards","Diamond","Clinic","Gold","OP","OP","Jeopardy","OP","Clinic","MICU","OP","Bronze","OP","OP","Clinic","OP","OP","ID","ID","ID","Clinic","MICU","OP","SLUH","SLUH","SLUH","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","OP","VA","VA","VA","Clinic","NF","NF","MICU","OP","OP","Clinic","NF","NF"],"counts":{"OP":16,"Cards":1,"Diamond":1,"Clinic":8,"Gold":1,"Jeopardy":1,"MICU":3,"Bronze":1,"ID":3,"SLUH":6,"VA":3,"NF":4},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R3_22","pgy":3,"pos":2,"type":"PGY3","schedule":["Bronze","Clinic","MICU","Diamond","Cards","Jeopardy","Gold","Clinic","OP","OP","OP","OP","OP","Clinic","MICU","OP","NF","NF","OP","Clinic","Bronze","OP","OP","OP","Cards","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","VA","VA","VA","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","VA","VA","VA"],"counts":{"Bronze":2,"Clinic":8,"MICU":2,"Diamond":1,"Cards":2,"Jeopardy":1,"Gold":1,"OP":17,"NF":2,"SLUH":6,"VA":6},"ip":22,"op":18,"clinic":8,"maxConsec":3},{"id":"R3_23","pgy":3,"pos":5,"type":"PGY3","schedule":["SLUH","SLUH","SLUH","OP","Clinic","MICU","OP","OP","Bronze","OP","Clinic","OP","VA","VA","VA","OP","Clinic","OP","NF","NF","MICU","OP","Clinic","Cards","Gold","OP","OP","MICU","Clinic","Diamond","Cards","OP","OP","Bronze","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","VA","VA","VA","OP","Clinic","MICU"],"counts":{"SLUH":6,"OP":16,"Clinic":8,"MICU":4,"Bronze":2,"VA":6,"NF":2,"Cards":2,"Gold":1,"Diamond":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_24","pgy":3,"pos":3,"type":"PGY3","schedule":["OP","OP","Clinic","Gold","OP","OP","MICU","OP","Clinic","SLUH","SLUH","SLUH","Jeopardy","Bronze","Clinic","OP","NF","NF","Cards","OP","Clinic","OP","OP","MICU","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","VA","VA","VA","OP","MICU","Clinic","Bronze","NF","NF","OP","OP","Clinic","ID","ID","ID"],"counts":{"OP":16,"Clinic":8,"Gold":1,"MICU":3,"SLUH":6,"Jeopardy":1,"Bronze":2,"NF":4,"Cards":1,"VA":3,"ID":3},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R3_25","pgy":3,"pos":5,"type":"PGY3","schedule":["SLUH","SLUH","SLUH","OP","Clinic","MICU","NF","NF","OP","Bronze","Clinic","OP","MICU","OP","Cards","OP","Clinic","OP","VA","VA","VA","Jeopardy","Clinic","OP","NF","NF","MICU","OP","Clinic","OP","Bronze","OP","Cards","OP","Clinic","Cards","Diamond","Gold","OP","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","MICU"],"counts":{"SLUH":6,"OP":15,"Clinic":8,"MICU":4,"NF":4,"Bronze":2,"Cards":3,"VA":3,"Jeopardy":1,"Diamond":1,"Gold":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R3_26","pgy":3,"pos":3,"type":"PGY3","schedule":["MICU","Diamond","Clinic","Bronze","OP","Cards","NF","NF","Clinic","VA","VA","VA","OP","Gold","Clinic","MICU","OP","OP","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","MICU","NF","NF","Jeopardy","OP","Clinic","VA","VA","VA","OP","Cards","Clinic","MICU","OP","Bronze","OP","OP","Clinic","OP","OP","OP"],"counts":{"MICU":4,"Diamond":1,"Clinic":8,"Bronze":2,"OP":16,"Cards":2,"NF":4,"VA":6,"Gold":1,"SLUH":3,"Jeopardy":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R3_27","pgy":3,"pos":1,"type":"PGY3","schedule":["Clinic","OP","NF","NF","OP","MICU","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","OP","MICU","OP","Bronze","Clinic","OP","OP","VA","VA","VA","Clinic","Cards","NF","NF","OP","OP","Clinic","MICU","OP","SLUH","SLUH","SLUH","Clinic","OP","Cards","OP","NF","NF","Clinic","MICU","Gold","Bronze","OP","Jeopardy"],"counts":{"Clinic":8,"OP":15,"NF":6,"MICU":4,"SLUH":6,"Bronze":2,"VA":3,"Cards":2,"Gold":1,"Jeopardy":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_01","pgy":2,"pos":3,"type":"PGY2","schedule":["OP","OP","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","MICU","NF","NF","OP","Cards","Clinic","VA","VA","VA","OP","Bronze","Clinic","MICU","Gold","Diamond","OP","OP","Clinic","OP","OP","OP","OP","Jeopardy","Clinic","MICU","NF","NF","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","Cards","Clinic","VA","VA","VA"],"counts":{"OP":15,"Clinic":8,"SLUH":6,"MICU":3,"NF":4,"Cards":2,"VA":6,"Bronze":1,"Gold":1,"Diamond":1,"Jeopardy":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_02","pgy":2,"pos":6,"type":"PGY2","schedule":["OP","Gold","Bronze","OP","OP","Clinic","OP","OP","MICU","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","VA","VA","VA","OP","Cards","Clinic","NF","NF","MICU","OP","OP","Clinic","NF","NF","OP","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","VA","VA","VA","OP","Bronze","Clinic"],"counts":{"OP":17,"Gold":1,"Bronze":2,"Clinic":8,"MICU":3,"SLUH":6,"VA":6,"Cards":1,"NF":4},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_03","pgy":2,"pos":2,"type":"PGY2","schedule":["OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","Jeopardy","ID","ID","ID","OP","Clinic","NF","NF","MICU","OP","Bronze","Clinic","Cards","OP","OP","MICU","OP","Clinic","OP","VA","VA","VA","OP","Clinic","NF","NF","OP","Gold","MICU","Clinic","Diamond","OP","Bronze","OP","Cards","Clinic","OP","SLUH","SLUH","SLUH"],"counts":{"OP":14,"Clinic":8,"SLUH":6,"Jeopardy":1,"ID":3,"NF":4,"MICU":3,"Bronze":2,"Cards":2,"VA":3,"Gold":1,"Diamond":1},"ip":25,"op":15,"clinic":8,"maxConsec":3},{"id":"R2_04","pgy":2,"pos":4,"type":"PGY2","schedule":["VA","VA","VA","Clinic","NF","NF","MICU","OP","Bronze","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","Cards","Diamond","MICU","OP","Gold","Clinic","NF","NF","OP","OP","Bronze","Clinic","Cards","OP","VA","VA","VA","Clinic","MICU","OP","OP","OP","MICU","Clinic","Jeopardy","OP","OP","OP","OP","Clinic","OP","OP"],"counts":{"VA":6,"Clinic":8,"NF":4,"MICU":4,"OP":16,"Bronze":2,"SLUH":3,"Cards":2,"Diamond":1,"Gold":1,"Jeopardy":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_05","pgy":2,"pos":4,"type":"PGY2","schedule":["OP","MICU","Gold","Clinic","NF","NF","Bronze","OP","Cards","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","Jeopardy","SLUH","SLUH","SLUH","Clinic","Diamond","OP","SLUH","SLUH","SLUH","Clinic","NF","NF","MICU","OP","Bronze","Clinic","Cards","OP","OP","OP","OP","Clinic","OP","MICU","OP","OP","OP","Clinic","OP","OP"],"counts":{"OP":16,"MICU":4,"Gold":1,"Clinic":8,"NF":4,"Bronze":2,"Cards":2,"VA":3,"Jeopardy":1,"SLUH":6,"Diamond":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_06","pgy":2,"pos":3,"type":"PGY2","schedule":["NF","NF","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","OP","Bronze","OP","OP","OP","Clinic","MICU","OP","Cards","OP","OP","Clinic","VA","VA","VA","Jeopardy","OP","Clinic","OP","NF","NF","OP","MICU","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","Bronze","Diamond","Cards","OP","OP","Clinic","MICU","NF","NF"],"counts":{"NF":6,"Clinic":8,"SLUH":6,"OP":15,"MICU":4,"Bronze":2,"Cards":2,"VA":3,"Jeopardy":1,"Diamond":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_07","pgy":2,"pos":2,"type":"PGY2","schedule":["Bronze","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","NF","NF","MICU","OP","Cards","Clinic","MICU","Diamond","Jeopardy","Gold","OP","Clinic","OP","VA","VA","VA","OP","Clinic","NF","NF","MICU","OP","Bronze","Clinic","Cards","OP","OP","OP","MICU","Clinic","OP","OP","OP","OP","OP","Clinic","OP","SLUH","SLUH","SLUH"],"counts":{"Bronze":2,"Clinic":8,"OP":16,"SLUH":6,"NF":4,"MICU":4,"Cards":2,"Diamond":1,"Jeopardy":1,"Gold":1,"VA":3},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_08","pgy":2,"pos":5,"type":"PGY2","schedule":["OP","OP","OP","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","ID","ID","ID","OP","Clinic","MICU","NF","NF","OP","Bronze","Clinic","Jeopardy","VA","VA","VA","OP","Clinic","MICU","OP","Cards","NF","NF","Clinic","MICU","Gold","OP","Bronze","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","Cards"],"counts":{"OP":15,"Clinic":8,"SLUH":6,"ID":3,"MICU":3,"NF":4,"Bronze":2,"Jeopardy":1,"VA":3,"Cards":2,"Gold":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_09","pgy":2,"pos":4,"type":"PGY2","schedule":["NF","NF","MICU","Clinic","Bronze","OP","SLUH","SLUH","SLUH","Clinic","Cards","Diamond","MICU","OP","OP","Clinic","Gold","OP","OP","OP","OP","Clinic","OP","OP","VA","VA","VA","Clinic","NF","NF","MICU","OP","OP","Clinic","OP","Bronze","Jeopardy","Cards","OP","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","MICU","OP"],"counts":{"NF":4,"MICU":4,"Clinic":8,"Bronze":2,"OP":16,"SLUH":6,"Cards":2,"Diamond":1,"Gold":1,"VA":3,"Jeopardy":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_10","pgy":2,"pos":6,"type":"PGY2","schedule":["OP","OP","OP","MICU","OP","Clinic","VA","VA","VA","Jeopardy","OP","Clinic","NF","NF","Bronze","OP","Cards","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","MICU","Diamond","OP","Gold","OP","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","VA","VA","VA","OP","OP","Clinic","NF","NF","MICU","OP","Cards","Clinic"],"counts":{"OP":15,"MICU":3,"Clinic":8,"VA":6,"Jeopardy":1,"NF":4,"Bronze":1,"Cards":2,"SLUH":6,"Diamond":1,"Gold":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_11","pgy":2,"pos":2,"type":"PGY2","schedule":["Cards","Clinic","OP","VA","VA","VA","OP","Clinic","MICU","OP","NF","NF","Bronze","Clinic","MICU","Gold","Diamond","OP","OP","Clinic","OP","OP","NF","NF","Cards","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","MICU","OP","Bronze","OP","OP","Clinic","OP","VA","VA","VA","OP","Clinic","MICU","Jeopardy","OP","OP"],"counts":{"Cards":2,"Clinic":8,"OP":16,"VA":6,"MICU":4,"NF":4,"Bronze":2,"Gold":1,"Diamond":1,"SLUH":3,"Jeopardy":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_12","pgy":2,"pos":5,"type":"PGY2","schedule":["OP","OP","MICU","OP","Clinic","OP","VA","VA","VA","OP","Clinic","OP","NF","NF","MICU","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","Cards","OP","OP","Bronze","Jeopardy","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","MICU","NF","NF","OP","Diamond","Clinic","Bronze","OP","MICU","NF","NF","Clinic","OP"],"counts":{"OP":16,"MICU":4,"Clinic":8,"VA":3,"NF":6,"SLUH":6,"Cards":1,"Bronze":2,"Jeopardy":1,"Diamond":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_13","pgy":2,"pos":6,"type":"PGY2","schedule":["MICU","OP","NF","NF","Diamond","Clinic","Bronze","Gold","Cards","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","VA","VA","VA","OP","OP","Clinic","NF","NF","MICU","OP","Bronze","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","Cards","OP","MICU","Jeopardy","OP","Clinic","OP","OP","OP","OP","OP","Clinic"],"counts":{"MICU":4,"OP":16,"NF":4,"Diamond":1,"Clinic":8,"Bronze":2,"Gold":1,"Cards":2,"SLUH":6,"VA":3,"Jeopardy":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_14","pgy":2,"pos":1,"type":"PGY2","schedule":["Clinic","MICU","OP","VA","VA","VA","Clinic","Bronze","OP","SLUH","SLUH","SLUH","Clinic","Cards","NF","NF","OP","MICU","Clinic","Jeopardy","OP","Cards","NF","NF","Clinic","OP","Diamond","MICU","OP","Bronze","Clinic","OP","OP","Gold","OP","Cards","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","OP","OP","OP","OP"],"counts":{"Clinic":8,"MICU":4,"OP":15,"VA":6,"Bronze":2,"SLUH":3,"Cards":3,"NF":4,"Jeopardy":1,"Diamond":1,"Gold":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_15","pgy":2,"pos":3,"type":"PGY2","schedule":["OP","OP","Clinic","ID","ID","ID","OP","OP","Clinic","MICU","NF","NF","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","Cards","Clinic","VA","VA","VA","OP","MICU","Clinic","SLUH","SLUH","SLUH","OP","Bronze","Clinic","OP","Jeopardy","Bronze","NF","NF","Clinic","MICU","OP","Cards","Diamond","Gold","Clinic","OP","OP","OP"],"counts":{"OP":14,"Clinic":8,"ID":3,"MICU":3,"NF":4,"SLUH":6,"Cards":2,"VA":3,"Bronze":2,"Jeopardy":1,"Diamond":1,"Gold":1},"ip":25,"op":15,"clinic":8,"maxConsec":3},{"id":"R2_16","pgy":2,"pos":5,"type":"PGY2","schedule":["OP","OP","OP","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","VA","VA","VA","OP","Clinic","MICU","NF","NF","OP","MICU","Clinic","OP","ID","ID","ID","OP","Clinic","Bronze","NF","NF","OP","MICU","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","Gold","Bronze","OP","Cards","OP","Clinic","Diamond"],"counts":{"OP":16,"Clinic":8,"SLUH":6,"VA":3,"MICU":3,"NF":4,"ID":3,"Bronze":2,"Gold":1,"Cards":1,"Diamond":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_17","pgy":2,"pos":1,"type":"PGY2","schedule":["Clinic","MICU","OP","Bronze","NF","NF","Clinic","Cards","Diamond","Gold","OP","OP","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","OP","SLUH","SLUH","SLUH","Clinic","OP","NF","NF","OP","MICU","Clinic","OP","Bronze","OP","Cards","OP","Clinic","OP","OP","MICU","OP","Jeopardy","Clinic","OP","OP","SLUH","SLUH","SLUH"],"counts":{"Clinic":8,"MICU":4,"OP":16,"Bronze":2,"NF":4,"Cards":2,"Diamond":1,"Gold":1,"VA":3,"SLUH":6,"Jeopardy":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_18","pgy":2,"pos":4,"type":"PGY2","schedule":["OP","OP","OP","Clinic","OP","OP","OP","MICU","OP","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","NF","NF","Bronze","OP","Cards","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","OP","SLUH","SLUH","SLUH","Clinic","NF","NF","MICU","OP","Bronze","Clinic","OP","OP","VA","VA","VA","Clinic","Gold","Cards"],"counts":{"OP":16,"Clinic":8,"MICU":3,"SLUH":6,"NF":4,"Bronze":2,"Cards":2,"VA":6,"Gold":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_19","pgy":2,"pos":5,"type":"PGY2","schedule":["VA","VA","VA","Jeopardy","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","MICU","OP","OP","NF","NF","Clinic","OP","OP","OP","Bronze","OP","Clinic","OP","MICU","OP","OP","Cards","Clinic","OP","VA","VA","VA","OP","Clinic","OP","ID","ID","ID","OP","Clinic","MICU","NF","NF","OP","MICU","Clinic","Bronze"],"counts":{"VA":6,"Jeopardy":1,"Clinic":8,"OP":16,"SLUH":3,"MICU":4,"NF":4,"Bronze":2,"Cards":1,"ID":3},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_20","pgy":2,"pos":1,"type":"PGY2","schedule":["Clinic","OP","NF","NF","MICU","OP","Clinic","OP","OP","Cards","OP","Bronze","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","MICU","NF","NF","OP","OP","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","OP","SLUH","SLUH","SLUH","Clinic","Jeopardy","OP","Cards","NF","NF","Clinic","Bronze","Diamond","MICU","OP","OP"],"counts":{"Clinic":8,"OP":15,"NF":6,"MICU":4,"Cards":2,"Bronze":2,"SLUH":6,"VA":3,"Jeopardy":1,"Diamond":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_21","pgy":2,"pos":1,"type":"PGY2","schedule":["Clinic","OP","Cards","OP","OP","MICU","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","OP","VA","VA","VA","Clinic","Bronze","NF","NF","Jeopardy","MICU","Clinic","OP","OP","Cards","Gold","OP","Clinic","OP","OP","ID","ID","ID","Clinic","MICU","NF","NF","OP","Diamond","Clinic","OP","OP","SLUH","SLUH","SLUH"],"counts":{"Clinic":8,"OP":15,"Cards":2,"MICU":3,"SLUH":6,"VA":3,"Bronze":1,"NF":4,"Jeopardy":1,"Gold":1,"ID":3,"Diamond":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_22","pgy":2,"pos":2,"type":"PGY2","schedule":["MICU","Clinic","Bronze","OP","NF","NF","Cards","Clinic","Gold","MICU","Diamond","OP","OP","Clinic","Jeopardy","OP","OP","OP","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","VA","VA","VA","OP","Clinic","NF","NF","MICU","OP","Bronze","Clinic","Cards","OP","OP","MICU","OP","Clinic","OP","SLUH","SLUH","SLUH"],"counts":{"MICU":4,"Clinic":8,"Bronze":2,"OP":16,"NF":4,"Cards":2,"Gold":1,"Diamond":1,"Jeopardy":1,"SLUH":6,"VA":3},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_23","pgy":2,"pos":2,"type":"PGY2","schedule":["OP","Clinic","OP","OP","OP","OP","MICU","Clinic","OP","VA","VA","VA","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","NF","NF","Bronze","OP","MICU","Clinic","Cards","Diamond","OP","Jeopardy","Cards","Clinic","OP","VA","VA","VA","OP","Clinic","OP","ID","ID","ID","OP","Clinic","NF","NF","MICU","OP"],"counts":{"OP":16,"Clinic":8,"MICU":3,"VA":6,"SLUH":3,"NF":4,"Bronze":1,"Cards":2,"Diamond":1,"Jeopardy":1,"ID":3},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_24","pgy":2,"pos":2,"type":"PGY2","schedule":["Jeopardy","Clinic","OP","OP","OP","OP","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","VA","VA","VA","OP","Clinic","OP","ID","ID","ID","OP","Clinic","NF","NF","MICU","OP","MICU","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","NF","NF","MICU","OP","Bronze","Clinic","Bronze","Diamond","Cards","OP"],"counts":{"Jeopardy":1,"Clinic":8,"OP":16,"SLUH":6,"VA":3,"ID":3,"NF":4,"MICU":3,"Bronze":2,"Diamond":1,"Cards":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_25","pgy":2,"pos":6,"type":"PGY2","schedule":["MICU","OP","NF","NF","Bronze","Clinic","SLUH","SLUH","SLUH","OP","Cards","Clinic","MICU","Diamond","Gold","OP","OP","Clinic","OP","OP","OP","Bronze","OP","Clinic","VA","VA","VA","OP","Cards","Clinic","NF","NF","MICU","Jeopardy","OP","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","MICU","OP","OP","OP","OP","Clinic"],"counts":{"MICU":4,"OP":16,"NF":4,"Bronze":2,"Clinic":8,"SLUH":6,"Cards":2,"Diamond":1,"Gold":1,"VA":3,"Jeopardy":1},"ip":23,"op":17,"clinic":8,"maxConsec":3},{"id":"R2_26","pgy":2,"pos":1,"type":"PGY2","schedule":["Clinic","Bronze","OP","Cards","OP","Gold","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","NF","NF","OP","OP","Clinic","OP","MICU","Diamond","OP","OP","Clinic","OP","Jeopardy","SLUH","SLUH","SLUH","Clinic","OP","OP","Cards","NF","NF","Clinic","MICU","OP","SLUH","SLUH","SLUH","Clinic","OP","OP","VA","VA","VA"],"counts":{"Clinic":8,"Bronze":1,"OP":15,"Cards":2,"Gold":1,"VA":6,"MICU":3,"NF":4,"Diamond":1,"Jeopardy":1,"SLUH":6},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_27","pgy":2,"pos":1,"type":"PGY2","schedule":["Clinic","OP","OP","Cards","OP","OP","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","OP","SLUH","SLUH","SLUH","Clinic","Diamond","NF","NF","OP","MICU","Clinic","Bronze","OP","OP","OP","OP","Clinic","OP","Gold","OP","NF","NF","Clinic","MICU","OP","SLUH","SLUH","SLUH","Clinic","Cards","Jeopardy","VA","VA","VA"],"counts":{"Clinic":8,"OP":15,"Cards":2,"VA":6,"MICU":3,"SLUH":6,"Diamond":1,"NF":4,"Bronze":1,"Gold":1,"Jeopardy":1},"ip":24,"op":16,"clinic":8,"maxConsec":3},{"id":"R2_28","pgy":2,"pos":5,"type":"PGY2","schedule":["SLUH","SLUH","SLUH","OP","Clinic","OP","VA","VA","VA","OP","Clinic","MICU","NF","NF","OP","Bronze","Clinic","Cards","Gold","OP","OP","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","ID","ID","ID","OP","Clinic","MICU","NF","NF","Jeopardy","MICU","Clinic","OP","Cards","OP","Bronze","OP","Clinic","OP"],"counts":{"SLUH":6,"OP":15,"Clinic":8,"VA":3,"MICU":3,"NF":4,"Bronze":2,"Cards":2,"Gold":1,"ID":3,"Jeopardy":1},"ip":24,"op":16,"clinic":8,"maxConsec":3}],"coverage":{"SLUH":[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],"VA":[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],"ID":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"NF":[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],"MICU":[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],"Bronze":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"Cards":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"Diamond":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"Gold":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"Jeopardy":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},"intern":{"targets":{"SLUH":4,"VA":5,"NF":4,"MICU":2,"Cards":1,"Jeopardy":1},"full_targets":{"SLUH":4,"VA":5},"residents":[{"id":"I_cat01","pgy":1,"pos":1,"type":"cat","schedule":["Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","NF","NF","Jeopardy","OP","Clinic","OP","NF","NF","OP","OP","Clinic","Cards","OP","MICU","OP","OP","Clinic","OP","Jeopardy","OP","NF","NF","Clinic","OP","OP","VA","VA","VA","Clinic","OP","NF","NF","MICU","OP"],"counts":{"Clinic":8,"OP":17,"SLUH":3,"VA":6,"MICU":3,"NF":8,"Jeopardy":2,"Cards":1},"ip":21,"op":19,"clinic":8,"maxConsec":3},{"id":"I_cat02","pgy":1,"pos":2,"type":"cat","schedule":["OP","Clinic","NF","NF","OP","Jeopardy","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","MICU","OP","NF","NF","OP","Clinic","OP","OP","OP","OP","OP","Clinic","OP","VA","VA","VA","OP","Clinic","NF","NF","MICU","OP","Cards","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","NF","NF","MICU","Jeopardy"],"counts":{"OP":17,"Clinic":8,"NF":8,"Jeopardy":2,"SLUH":6,"MICU":3,"VA":3,"Cards":1},"ip":21,"op":19,"clinic":8,"maxConsec":3},{"id":"I_cat03","pgy":1,"pos":3,"type":"cat","schedule":["OP","OP","Clinic","SLUH","SLUH","SLUH","Jeopardy","OP","Clinic","MICU","NF","NF","OP","OP","Clinic","VA","VA","VA","OP","Cards","Clinic","OP","NF","NF","OP","MICU","Clinic","VA","VA","VA","OP","OP","Clinic","MICU","NF","NF","OP","Jeopardy","Clinic","OP","OP","OP","OP","Cards","Clinic","OP","OP","OP"],"counts":{"OP":18,"Clinic":8,"SLUH":3,"Jeopardy":2,"MICU":3,"NF":6,"VA":6,"Cards":2},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat04","pgy":1,"pos":4,"type":"cat","schedule":["OP","OP","Jeopardy","Clinic","OP","OP","OP","OP","OP","Clinic","OP","OP","NF","NF","OP","Clinic","MICU","OP","SLUH","SLUH","SLUH","Clinic","OP","OP","VA","VA","VA","Clinic","NF","NF","MICU","OP","Cards","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","OP","VA","VA","VA","Clinic","NF","NF"],"counts":{"OP":18,"Jeopardy":1,"Clinic":8,"NF":6,"MICU":2,"SLUH":6,"VA":6,"Cards":1},"ip":21,"op":19,"clinic":8,"maxConsec":3},{"id":"I_cat05","pgy":1,"pos":5,"type":"cat","schedule":["NF","NF","MICU","OP","Clinic","OP","OP","Cards","OP","OP","Clinic","OP","OP","OP","NF","NF","Clinic","OP","VA","VA","VA","OP","Clinic","MICU","OP","Jeopardy","NF","NF","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","OP","OP","OP","Cards","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","MICU"],"counts":{"NF":6,"MICU":3,"OP":19,"Clinic":8,"Cards":2,"VA":3,"Jeopardy":1,"SLUH":6},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat06","pgy":1,"pos":6,"type":"cat","schedule":["VA","VA","VA","OP","OP","Clinic","NF","NF","OP","OP","OP","Clinic","NF","NF","MICU","OP","Cards","Clinic","OP","Jeopardy","OP","MICU","OP","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","VA","VA","VA","OP","Cards","Clinic","OP","OP","OP","MICU","Jeopardy","Clinic","NF","NF","OP","OP","OP","Clinic"],"counts":{"VA":6,"OP":18,"Clinic":8,"NF":6,"MICU":3,"Cards":2,"Jeopardy":2,"SLUH":3},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat07","pgy":1,"pos":1,"type":"cat","schedule":["Clinic","Cards","OP","VA","VA","VA","Clinic","OP","NF","NF","MICU","OP","Clinic","OP","OP","MICU","OP","OP","Clinic","OP","NF","NF","OP","OP","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","Jeopardy","OP","OP","OP","OP","Clinic","OP","OP","VA","VA","VA","Clinic","MICU","NF","NF","OP","OP"],"counts":{"Clinic":8,"Cards":1,"OP":20,"VA":6,"NF":6,"MICU":3,"SLUH":3,"Jeopardy":1},"ip":19,"op":21,"clinic":8,"maxConsec":3},{"id":"I_cat08","pgy":1,"pos":2,"type":"cat","schedule":["Jeopardy","Clinic","OP","VA","VA","VA","OP","Clinic","NF","NF","OP","MICU","OP","Clinic","NF","NF","OP","OP","OP","Clinic","OP","OP","OP","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","OP","VA","VA","VA","OP","Clinic","NF","NF","Cards","OP","MICU","Clinic","OP","OP","NF","NF"],"counts":{"Jeopardy":1,"Clinic":8,"OP":18,"VA":6,"NF":8,"MICU":3,"SLUH":3,"Cards":1},"ip":21,"op":19,"clinic":8,"maxConsec":3},{"id":"I_cat09","pgy":1,"pos":3,"type":"cat","schedule":["Cards","OP","Clinic","MICU","NF","NF","OP","OP","Clinic","OP","OP","OP","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","VA","VA","VA","OP","OP","Clinic","MICU","NF","NF","Jeopardy","OP","Clinic","OP","NF","NF","OP","MICU","Clinic","OP","OP","Cards","OP","OP","Clinic","VA","VA","VA"],"counts":{"Cards":2,"OP":19,"Clinic":8,"MICU":3,"NF":6,"SLUH":3,"VA":6,"Jeopardy":1},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat10","pgy":1,"pos":4,"type":"cat","schedule":["SLUH","SLUH","SLUH","Clinic","MICU","OP","VA","VA","VA","Clinic","NF","NF","Jeopardy","OP","Cards","Clinic","OP","OP","VA","VA","VA","Clinic","NF","NF","MICU","OP","OP","Clinic","OP","Cards","OP","OP","MICU","Clinic","OP","OP","OP","OP","OP","Clinic","NF","NF","OP","OP","OP","Clinic","OP","OP"],"counts":{"SLUH":3,"Clinic":8,"MICU":3,"OP":19,"VA":6,"NF":6,"Jeopardy":1,"Cards":2},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat11","pgy":1,"pos":5,"type":"cat","schedule":["VA","VA","VA","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","MICU","NF","NF","Jeopardy","Cards","Clinic","OP","MICU","OP","OP","OP","Clinic","OP","VA","VA","VA","OP","Clinic","OP","NF","NF","OP","OP","Clinic","Cards","NF","NF","OP","OP","Clinic","MICU","OP","OP","OP","OP","Clinic","OP"],"counts":{"VA":6,"OP":19,"Clinic":8,"SLUH":3,"MICU":3,"NF":6,"Jeopardy":1,"Cards":2},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat12","pgy":1,"pos":6,"type":"cat","schedule":["NF","NF","OP","OP","MICU","Clinic","VA","VA","VA","Jeopardy","OP","Clinic","Cards","OP","OP","OP","OP","Clinic","OP","OP","OP","MICU","OP","Clinic","NF","NF","OP","OP","OP","Clinic","VA","VA","VA","Jeopardy","OP","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","OP","OP","NF","NF","OP","Clinic"],"counts":{"NF":6,"OP":19,"MICU":3,"Clinic":8,"VA":6,"Jeopardy":2,"Cards":1,"SLUH":3},"ip":19,"op":21,"clinic":8,"maxConsec":3},{"id":"I_cat13","pgy":1,"pos":1,"type":"cat","schedule":["Clinic","OP","NF","NF","OP","OP","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","MICU","OP","VA","VA","VA","Clinic","OP","NF","NF","Jeopardy","Cards","Clinic","OP","NF","NF","OP","MICU","Clinic","OP","OP","OP","OP","OP","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","MICU","OP","NF","NF"],"counts":{"Clinic":8,"OP":18,"NF":8,"SLUH":6,"MICU":3,"VA":3,"Jeopardy":1,"Cards":1},"ip":21,"op":19,"clinic":8,"maxConsec":3},{"id":"I_cat14","pgy":1,"pos":2,"type":"cat","schedule":["OP","Clinic","OP","VA","VA","VA","OP","Clinic","MICU","OP","NF","NF","OP","Clinic","NF","NF","OP","MICU","OP","Clinic","OP","SLUH","SLUH","SLUH","Jeopardy","Clinic","Cards","OP","OP","OP","OP","Clinic","NF","NF","OP","Jeopardy","MICU","Clinic","OP","VA","VA","VA","OP","Clinic","OP","OP","OP","Cards"],"counts":{"OP":18,"Clinic":8,"VA":6,"MICU":3,"NF":6,"SLUH":3,"Jeopardy":2,"Cards":2},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat15","pgy":1,"pos":3,"type":"cat","schedule":["NF","NF","Clinic","Jeopardy","OP","OP","MICU","OP","Clinic","OP","Cards","OP","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","VA","VA","VA","OP","MICU","Clinic","OP","NF","NF","OP","OP","Clinic","MICU","OP","OP","NF","NF","Clinic","OP","OP","Jeopardy","OP","OP","Clinic","VA","VA","VA"],"counts":{"NF":6,"Clinic":8,"Jeopardy":2,"OP":19,"MICU":3,"Cards":1,"SLUH":3,"VA":6},"ip":19,"op":21,"clinic":8,"maxConsec":3},{"id":"I_cat16","pgy":1,"pos":4,"type":"cat","schedule":["VA","VA","VA","Clinic","OP","MICU","OP","Jeopardy","Cards","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","OP","VA","VA","VA","Clinic","NF","NF","OP","OP","MICU","Clinic","NF","NF","OP","Cards","OP","Clinic","OP","OP","NF","NF","MICU","Clinic","OP","OP","Jeopardy","OP","OP","Clinic","OP","OP"],"counts":{"VA":6,"Clinic":8,"OP":18,"MICU":3,"Jeopardy":2,"Cards":2,"SLUH":3,"NF":6},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat17","pgy":1,"pos":5,"type":"cat","schedule":["SLUH","SLUH","SLUH","OP","Clinic","MICU","NF","NF","OP","OP","Clinic","OP","VA","VA","VA","OP","Clinic","MICU","NF","NF","Jeopardy","Cards","Clinic","OP","OP","OP","OP","OP","Clinic","OP","OP","OP","OP","OP","Clinic","OP","VA","VA","VA","OP","Clinic","MICU","NF","NF","OP","Cards","Clinic","OP"],"counts":{"SLUH":3,"OP":19,"Clinic":8,"MICU":3,"NF":6,"VA":6,"Jeopardy":1,"Cards":2},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat18","pgy":1,"pos":6,"type":"cat","schedule":["VA","VA","VA","OP","OP","Clinic","NF","NF","MICU","OP","OP","Clinic","OP","OP","OP","Jeopardy","OP","Clinic","MICU","OP","OP","OP","Cards","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","NF","NF","MICU","OP","OP","Clinic","VA","VA","VA","OP","OP","Clinic","NF","NF","OP","MICU","OP","Clinic"],"counts":{"VA":6,"OP":19,"Clinic":8,"NF":6,"MICU":4,"Jeopardy":1,"Cards":1,"SLUH":3},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat19","pgy":1,"pos":1,"type":"cat","schedule":["Clinic","MICU","NF","NF","OP","Cards","Clinic","OP","OP","VA","VA","VA","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","MICU","OP","OP","OP","OP","Clinic","OP","NF","NF","Cards","Jeopardy","Clinic","MICU","OP","OP","OP","OP","Clinic","OP","OP","OP","OP","OP","Clinic","OP","OP","VA","VA","VA"],"counts":{"Clinic":8,"MICU":3,"NF":4,"OP":21,"Cards":2,"VA":6,"SLUH":3,"Jeopardy":1},"ip":18,"op":22,"clinic":8,"maxConsec":3},{"id":"I_cat20","pgy":1,"pos":2,"type":"cat","schedule":["OP","Clinic","OP","VA","VA","VA","OP","Clinic","NF","NF","MICU","OP","MICU","Clinic","OP","OP","OP","Jeopardy","OP","Clinic","SLUH","SLUH","SLUH","OP","Cards","Clinic","OP","VA","VA","VA","OP","Clinic","NF","NF","OP","MICU","OP","Clinic","NF","NF","OP","OP","OP","Clinic","MICU","OP","OP","OP"],"counts":{"OP":19,"Clinic":8,"VA":6,"NF":6,"MICU":4,"Jeopardy":1,"SLUH":3,"Cards":1},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat21","pgy":1,"pos":3,"type":"cat","schedule":["OP","OP","Clinic","OP","NF","NF","OP","OP","Clinic","OP","OP","OP","NF","NF","Clinic","VA","VA","VA","Jeopardy","MICU","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","MICU","OP","Cards","OP","Clinic","SLUH","SLUH","SLUH","OP","OP","Clinic","OP","NF","NF","MICU","Jeopardy","Clinic","OP","NF","NF"],"counts":{"OP":17,"Clinic":8,"NF":8,"VA":3,"Jeopardy":2,"MICU":3,"SLUH":6,"Cards":1},"ip":21,"op":19,"clinic":8,"maxConsec":3},{"id":"I_cat22","pgy":1,"pos":4,"type":"cat","schedule":["MICU","Jeopardy","OP","Clinic","OP","OP","VA","VA","VA","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","NF","NF","Cards","OP","MICU","Clinic","NF","NF","OP","OP","OP","Clinic","OP","OP","NF","NF","OP","Clinic","MICU","OP","VA","VA","VA","Clinic","OP","OP","Cards","OP","OP","Clinic","Jeopardy","OP"],"counts":{"MICU":3,"Jeopardy":2,"OP":18,"Clinic":8,"VA":6,"SLUH":3,"NF":6,"Cards":2},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat23","pgy":1,"pos":5,"type":"cat","schedule":["MICU","OP","OP","Cards","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","VA","VA","VA","OP","Clinic","OP","NF","NF","MICU","OP","Clinic","Jeopardy","NF","NF","OP","OP","Clinic","OP","VA","VA","VA","OP","Clinic","MICU","Jeopardy","OP","NF","NF","Clinic","OP","OP","OP","Cards","OP","Clinic","OP"],"counts":{"MICU":3,"OP":18,"Cards":2,"Clinic":8,"SLUH":3,"VA":6,"NF":6,"Jeopardy":2},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat24","pgy":1,"pos":6,"type":"cat","schedule":["OP","OP","OP","OP","Cards","Clinic","VA","VA","VA","OP","OP","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","NF","NF","OP","OP","MICU","Clinic","NF","NF","Jeopardy","OP","Jeopardy","Clinic","OP","OP","NF","NF","OP","Clinic","OP","MICU","OP","OP","OP","Clinic","VA","VA","VA","OP","Cards","Clinic"],"counts":{"OP":18,"Cards":2,"Clinic":8,"VA":6,"SLUH":3,"MICU":3,"NF":6,"Jeopardy":2},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_cat25","pgy":1,"pos":1,"type":"cat","schedule":["Clinic","OP","OP","OP","NF","NF","Clinic","MICU","Jeopardy","Cards","OP","OP","Clinic","OP","OP","OP","NF","NF","Clinic","OP","OP","VA","VA","VA","Clinic","OP","MICU","OP","OP","OP","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","MICU","Jeopardy","NF","NF","Clinic","OP","OP","SLUH","SLUH","SLUH"],"counts":{"Clinic":8,"OP":19,"NF":6,"MICU":3,"Jeopardy":2,"Cards":1,"VA":3,"SLUH":6},"ip":19,"op":21,"clinic":8,"maxConsec":3},{"id":"I_cat26","pgy":1,"pos":2,"type":"cat","schedule":["OP","Clinic","OP","MICU","Jeopardy","OP","OP","Clinic","NF","NF","OP","Cards","OP","Clinic","OP","MICU","OP","OP","OP","Clinic","NF","NF","OP","OP","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","VA","VA","VA","OP","Clinic","OP","MICU","NF","NF","OP","Clinic","OP","SLUH","SLUH","SLUH"],"counts":{"OP":20,"Clinic":8,"MICU":3,"Jeopardy":1,"NF":6,"Cards":1,"SLUH":6,"VA":3},"ip":19,"op":21,"clinic":8,"maxConsec":3},{"id":"I_pre01","pgy":1,"pos":3,"type":"prelim","schedule":["OP","OP","Clinic","SLUH","SLUH","SLUH","OP","MICU","Clinic","OP","NF","NF","OP","Cards","Clinic","VA","VA","VA","OP","OP","Clinic","Jeopardy","MICU","OP","NF","NF","Clinic","Cards","OP","OP","OP","OP","Clinic","OP","OP","OP","NF","NF","Clinic","VA","VA","VA","OP","MICU","Clinic","Jeopardy","OP","OP"],"counts":{"OP":18,"Clinic":8,"SLUH":3,"MICU":3,"NF":6,"Cards":2,"VA":6,"Jeopardy":2},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_pre02","pgy":1,"pos":4,"type":"prelim","schedule":["OP","OP","Cards","Clinic","NF","NF","MICU","OP","OP","Clinic","Jeopardy","OP","VA","VA","VA","Clinic","NF","NF","OP","OP","OP","Clinic","OP","MICU","OP","OP","OP","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","NF","NF","MICU","OP","Cards","Clinic","OP","OP","VA","VA","VA","Clinic","OP","OP"],"counts":{"OP":19,"Cards":2,"Clinic":8,"NF":6,"MICU":3,"Jeopardy":1,"VA":6,"SLUH":3},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_pre03","pgy":1,"pos":5,"type":"prelim","schedule":["NF","NF","MICU","OP","Clinic","OP","Cards","OP","OP","OP","Clinic","Jeopardy","MICU","OP","OP","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","OP","VA","VA","VA","OP","Clinic","MICU","NF","NF","OP","Cards","Clinic","OP","OP","OP","Jeopardy","OP","Clinic","OP","SLUH","SLUH","SLUH","OP","Clinic","MICU"],"counts":{"NF":4,"MICU":4,"OP":19,"Clinic":8,"Cards":2,"Jeopardy":2,"SLUH":6,"VA":3},"ip":19,"op":21,"clinic":8,"maxConsec":3},{"id":"I_pre04","pgy":1,"pos":6,"type":"prelim","schedule":["SLUH","SLUH","SLUH","OP","OP","Clinic","NF","NF","OP","MICU","OP","Clinic","VA","VA","VA","OP","OP","Clinic","NF","NF","Cards","OP","OP","Clinic","MICU","OP","OP","Jeopardy","OP","Clinic","OP","OP","OP","OP","Jeopardy","Clinic","VA","VA","VA","OP","MICU","Clinic","NF","NF","OP","MICU","OP","Clinic"],"counts":{"SLUH":3,"OP":18,"Clinic":8,"NF":6,"MICU":4,"VA":6,"Cards":1,"Jeopardy":2},"ip":20,"op":20,"clinic":8,"maxConsec":3},{"id":"I_pre05","pgy":1,"pos":1,"type":"prelim","schedule":["Clinic","MICU","NF","NF","OP","OP","Clinic","OP","OP","VA","VA","VA","Clinic","Jeopardy","OP","OP","OP","Cards","Clinic","OP","OP","SLUH","SLUH","SLUH","Clinic","OP","NF","NF","MICU","OP","Clinic","MICU","OP","VA","VA","VA","Clinic","Cards","NF","NF","OP","OP","Clinic","OP","Jeopardy","OP","OP","OP"],"counts":{"Clinic":8,"MICU":3,"NF":6,"OP":18,"VA":6,"Jeopardy":2,"Cards":2,"SLUH":3},"ip":20,"op":20,"clinic":8,"maxConsec":3}],"rotators":[{"id":"Neuro_1","type":"Neuro","schedule":["","","","","","","","","","","","","","","","","VA","VA","VA","VA","","","","","VA","VA","VA","VA","","","","","","","","","","","","","SLUH","SLUH","SLUH","SLUH","SLUH","SLUH","SLUH","SLUH"]},{"id":"Neuro_2","type":"Neuro","schedule":["","","","","","","","","","","","","","","","","","","","","SLUH","SLUH","SLUH","SLUH","","","","","SLUH","SLUH","SLUH","SLUH","SLUH","SLUH","SLUH","SLUH","VA","VA","VA","VA","","","","","","","",""]},{"id":"Neuro_3","type":"Neuro","schedule":["","","","","VA","VA","VA","VA","","","","","VA","VA","VA","VA","","","","","","","","","","","","","","","","","VA","VA","VA","VA","","","","","","","","","","","",""]},{"id":"Neuro_4","type":"Neuro","schedule":["","","","","","","","","VA","VA","VA","VA","","","","","","","","","VA","VA","VA","VA","SLUH","SLUH","SLUH","SLUH","","","","","","","","","","","","","","","","","VA","VA","VA","VA"]},{"id":"Neuro_5","type":"Neuro","schedule":["VA","VA","VA","VA","","","","","SLUH","SLUH","SLUH","SLUH","","","","","","","","","","","","","","","","","","","","","","","","","","","","","VA","VA","VA","VA","","","",""]},{"id":"Neuro_6","type":"Neuro","schedule":["","","","","SLUH","SLUH","SLUH","SLUH","","","","","","","","","SLUH","SLUH","SLUH","SLUH","","","","","","","","","VA","VA","VA","VA","","","","","SLUH","SLUH","SLUH","SLUH","","","","","","","",""]},{"id":"Anes_1","type":"Anes","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","SLUH","SLUH","SLUH","SLUH","","","","","","","","","","","",""]},{"id":"Anes_2","type":"Anes","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","SLUH","SLUH","SLUH","SLUH","","","","","","","",""]},{"id":"Anes_3","type":"Anes","schedule":["","","","","","","","","","","","","","","","","SLUH","SLUH","SLUH","SLUH","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"Anes_4","type":"Anes","schedule":["SLUH","SLUH","SLUH","SLUH","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"Anes_5","type":"Anes","schedule":["","","","","","","","","","","","","SLUH","SLUH","SLUH","SLUH","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"Anes_6","type":"Anes","schedule":["","","","","","","","","SLUH","SLUH","SLUH","SLUH","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"Anes_7","type":"Anes","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","SLUH","SLUH","SLUH","SLUH","","","","","","","","","","","","","","","",""]},{"id":"Anes_8","type":"Anes","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","SLUH","SLUH","SLUH","SLUH"]},{"id":"Anes_9","type":"Anes","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","SLUH","SLUH","SLUH","SLUH","","","",""]},{"id":"Anes_10","type":"Anes","schedule":["","","","","SLUH","SLUH","SLUH","SLUH","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"Psych_1","type":"Psych","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","VA","VA","VA","VA","","","","","","","","","","","","","","","","","","","",""]},{"id":"Psych_2","type":"Psych","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","VA","VA","VA","VA","","","","","","","","","","","","","","","",""]},{"id":"Psych_3","type":"Psych","schedule":["","","","","","","","","VA","VA","VA","VA","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"Psych_4","type":"Psych","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","VA","VA","VA","VA","","","",""]},{"id":"Psych_5","type":"Psych","schedule":["","","","","","","","","","","","","","","","","VA","VA","VA","VA","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"Psych_6","type":"Psych","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","VA","VA","VA","VA"]},{"id":"Psych_7","type":"Psych","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","VA","VA","VA","VA","","","","","","","","","","","",""]},{"id":"Psych_8","type":"Psych","schedule":["","","","","","","","","","","","","","","","","","","","","VA","VA","VA","VA","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"EM_1","type":"EM","schedule":["","","","","","","","","ICU*","ICU*","ICU*","ICU*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"EM_2","type":"EM","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","ICU*","ICU*","ICU*","ICU*"]},{"id":"EM_3","type":"EM","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","ICU*","ICU*","ICU*","ICU*","","","",""]},{"id":"EM_4","type":"EM","schedule":["","","","","ICU*","ICU*","ICU*","ICU*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"EM_5","type":"EM","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","ICU*","ICU*","ICU*","ICU*","","","","","","","","","","","","","","","",""]},{"id":"EM_6","type":"EM","schedule":["ICU*","ICU*","ICU*","ICU*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"EM_7","type":"EM","schedule":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","ICU*","ICU*","ICU*","ICU*","","","","","","","","","","","",""]},{"id":"EM_8","type":"EM","schedule":["","","","","","","","","","","","","","","","","","","","","ICU*","ICU*","ICU*","ICU*","","","","","","","","","","","","","","","","","","","","","","","",""]}],"coverage":{"SLUH":[3,3,3,3,3,3,2,2,2,2,2,2,3,3,3,3,3,3,2,2,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"VA":[4,4,4,4,4,4,4,4,4,3,3,3,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,3,3,3,3,3,3],"NF":[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],"MICU":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"Cards":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"Jeopardy":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"rotator_coverage":{"SLUH":[1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"VA":[1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2]}},"weeks":48};

        let currentLevel = 'senior';
        const rotationColors = {
            'SLUH': '#B3D9FF', 'VA': '#FFCC99', 'NF': '#D9B3FF', 'MICU': '#FFB3B3',
            'Cards': '#FFFFB3', 'OP': '#B3FFB3', 'Clinic': '#FFFFFF', 'Jeopardy': '#FFE0B2',
            'ID': '#C8E6C9', 'Bronze': '#FFE0B2', 'Diamond': '#E1BEE7', 'Gold': '#FFF9C4', 'ICU*': '#FFD9D9'
        };

        function getData() {
            return RAW[currentLevel];
        }

        function getRotations() {
            if (currentLevel === 'senior') {
                return ['SLUH', 'VA', 'ID', 'NF', 'MICU', 'Bronze', 'Cards', 'Diamond', 'Gold', 'Jeopardy', 'OP', 'Clinic'];
            } else {
                return ['SLUH', 'VA', 'NF', 'MICU', 'Cards', 'Jeopardy', 'OP', 'Clinic', 'ICU*'];
            }
        }

        function getTargets() {
            const data = getData();
            if (currentLevel === 'intern') {
                return data.full_targets || data.targets;
            }
            return data.targets;
        }

        function switchLevel(level) {
            currentLevel = level;
            document.querySelectorAll('.level-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            const currentTab = document.querySelector('.tab-btn.active');
            const tabIndex = Array.from(document.querySelectorAll('.tab-btn')).indexOf(currentTab);

            rebuildAllTabs(tabIndex);
        }

        function rebuildAllTabs(activeIndex) {
            buildScheduleGrid();
            buildDeepDive();
            buildWeeklyStaffing();
            buildBalance();

            document.querySelectorAll('.tab-content').forEach((tab, i) => {
                tab.classList.toggle('active', i === activeIndex);
            });
            document.querySelectorAll('.tab-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i === activeIndex);
            });
        }

        function switchTab(index) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`tab-${index}`).classList.add('active');
            document.querySelectorAll('.tab-btn')[index].classList.add('active');

            if (index === 1) updateDeepDive();
            else if (index === 2) buildWeeklyStaffing();
            else if (index === 3) buildBalance();
        }

        function buildScheduleGrid() {
            const data = getData();
            const residents = data.residents;
            const rotators = data.rotators || [];
            const coverage = data.coverage;
            const targets = getTargets();
            const rotations = getRotations();

            const kpiHtml = `
                <div class="kpi-row">
                    <div class="kpi-card">
                        <div class="kpi-label">Total Residents</div>
                        <div class="kpi-value">${residents.length}</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Fully Staffed Weeks</div>
                        <div class="kpi-value">${countFullyStaffedWeeks(coverage, targets)} / 48</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Max Consecutive IP</div>
                        <div class="kpi-value">${Math.max(...residents.map(r => r.maxConsec), 0)}</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Active Rotations</div>
                        <div class="kpi-value">${rotations.length}</div>
                    </div>
                </div>
            `;
            document.getElementById('schedule-kpi').innerHTML = kpiHtml;

            const legendHtml = `<div class="color-legend">
                ${rotations.map(rot => `
                    <div class="legend-item">
                        <div class="legend-color" style="background: ${rotationColors[rot]}"></div>
                        <span>${rot}</span>
                    </div>
                `).join('')}
            </div>`;
            document.getElementById('schedule-legend').innerHTML = legendHtml;

            let tableHtml = '<thead><tr><th>Resident</th>';
            for (let w = 1; w <= 48; w++) tableHtml += `<th>W${w}</th>`;
            tableHtml += '<th colspan="12">Summary</th></tr></thead><tbody>';

            residents.forEach((resident, idx) => {
                tableHtml += `<tr><td>${resident.id}</td>`;
                resident.schedule.forEach((rot, weekIdx) => {
                    const bgColor = rotationColors[rot] || '#ffffff';
                    tableHtml += `<td class="rotation-cell" style="background: ${bgColor}; color: ${isLightColor(bgColor) ? '#000' : '#fff'};">${rot}</td>`;
                });
                tableHtml += `<td class="summary-cell">${resident.ip || 0}</td>`;
                tableHtml += `<td class="summary-cell">${resident.op || 0}</td>`;
                tableHtml += `<td class="summary-cell">${resident.clinic || 0}</td>`;
                tableHtml += `<td class="summary-cell">${resident.maxConsec || 0}</td>`;
                rotations.forEach(rot => {
                    const count = resident.counts[rot] || 0;
                    tableHtml += `<td class="summary-cell">${count}</td>`;
                });
                tableHtml += '</tr>';
            });

            if (currentLevel === 'intern' && rotators.length > 0) {
                const rotatorsByType = {};
                rotators.forEach(rot => {
                    if (!rotatorsByType[rot.type]) rotatorsByType[rot.type] = [];
                    rotatorsByType[rot.type].push(rot);
                });

                Object.entries(rotatorsByType).forEach(([type, rots]) => {
                    tableHtml += `<tr><td class="rotator-section-header" colspan="52">${type} Rotators</td></tr>`;
                    rots.forEach(rot => {
                        tableHtml += `<tr><td>${rot.id}</td>`;
                        rot.schedule.forEach(rotVal => {
                            const bgColor = rotationColors[rotVal] || '#ffffff';
                            tableHtml += `<td class="rotation-cell" style="background: ${bgColor}; color: ${isLightColor(bgColor) ? '#000' : '#fff'};">${rotVal}</td>`;
                        });
                        tableHtml += '<td colspan="16"></td></tr>';
                    });
                });
            }

            tableHtml += '<tr class="coverage-row"><td>Coverage</td>';
            rotations.forEach(rot => {
                const covArray = coverage[rot] || Array(48).fill(0);
                const target = targets[rot] || 0;
                let cellClass = 'coverage-cell';
                let meetsTarget = true;
                for (let w = 0; w < 48; w++) {
                    if (covArray[w] < target) {
                        meetsTarget = false;
                        break;
                    }
                }
                cellClass += meetsTarget ? ' meets-target' : ' below-target';
                tableHtml += `<td class="${cellClass}">Tgt:${target}</td>`;
            });
            tableHtml += '<td class="coverage-cell">IP</td><td class="coverage-cell">OP</td><td class="coverage-cell">Clinic</td><td class="coverage-cell">MaxCon</td>';
            rotations.forEach(() => tableHtml += '<td class="coverage-cell"></td>');
            tableHtml += '</tr>';

            tableHtml += '</tbody>';
            document.getElementById('schedule-table').innerHTML = tableHtml;
        }

        function countFullyStaffedWeeks(coverage, targets) {
            let count = 0;
            for (let week = 0; week < 48; week++) {
                let fullyStaffed = true;
                for (const [rot, target] of Object.entries(targets)) {
                    const covArray = coverage[rot] || Array(48).fill(0);
                    if (covArray[week] < target) {
                        fullyStaffed = false;
                        break;
                    }
                }
                if (fullyStaffed) count++;
            }
            return count;
        }

        function isLightColor(hex) {
            const rgb = parseInt(hex.slice(1), 16);
            const r = (rgb >> 16) & 0xff;
            const g = (rgb >> 8) & 0xff;
            const b = (rgb >> 0) & 0xff;
            const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
            return luminance > 0.5;
        }

        function buildDeepDive() {
            const data = getData();
            const residents = data.residents;
            const select = document.getElementById('resident-select');
            select.innerHTML = residents.map((r, i) => `<option value="${i}">${r.id} (${r.type})</option>`).join('');
        }

        function updateDeepDive() {
            const data = getData();
            const residents = data.residents;
            const selectIdx = parseInt(document.getElementById('resident-select').value);
            const resident = residents[selectIdx];
            const rotations = getRotations();

            let timelineHtml = '<div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 1rem;">';
            timelineHtml += '<div class="chart-title">48-Week Schedule Timeline</div>';
            timelineHtml += '<div class="timeline-bar">';
            resident.schedule.forEach(rot => {
                const color = rotationColors[rot] || '#ffffff';
                timelineHtml += `<div class="timeline-segment" style="background: ${color}; flex: 1; color: ${isLightColor(color) ? '#000' : '#fff'};">${rot}</div>`;
            });
            timelineHtml += '</div></div>';
            document.getElementById('deepdive-timeline').innerHTML = timelineHtml;

            let statsHtml = '<div class="stat-grid">';
            statsHtml += `<div class="stat-item"><div class="stat-label">IP Weeks</div><div class="stat-value">${resident.ip || 0}</div></div>`;
            statsHtml += `<div class="stat-item"><div class="stat-label">OP Weeks</div><div class="stat-value">${resident.op || 0}</div></div>`;
            statsHtml += `<div class="stat-item"><div class="stat-label">Clinic Weeks</div><div class="stat-value">${resident.clinic || 0}</div></div>`;
            statsHtml += `<div class="stat-item"><div class="stat-label">Max Consecutive</div><div class="stat-value">${resident.maxConsec || 0}</div></div>`;
            statsHtml += '</div>';
            document.getElementById('deepdive-stats').innerHTML = statsHtml;

            const traceResident = {
                x: rotations,
                y: rotations.map(rot => resident.counts[rot] || 0),
                name: 'This Resident',
                type: 'bar',
                marker: { color: '#3b82f6' }
            };

            const cohortAvg = rotations.map(rot => {
                const totalForRot = residents.reduce((sum, r) => sum + (r.counts[rot] || 0), 0);
                return totalForRot / residents.length;
            });

            const traceCohort = {
                x: rotations,
                y: cohortAvg,
                name: 'Cohort Average',
                type: 'bar',
                marker: { color: '#60a5fa' }
            };

            const layout = {
                title: 'Rotation Counts: Resident vs Cohort Average',
                barmode: 'group',
                height: 400,
                margin: { b: 120 },
                xaxis: { tickangle: -45 }
            };

            Plotly.newPlot('deepdive-chart', [traceResident, traceCohort], layout, { responsive: true });

            let percentileHtml = '<div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 1rem;">';
            percentileHtml += '<div class="chart-title">Percentile Rankings</div>';
            rotations.forEach(rot => {
                const residentCount = resident.counts[rot] || 0;
                const allCounts = residents.map(r => r.counts[rot] || 0).sort((a, b) => a - b);
                const percentile = (allCounts.filter(c => c <= residentCount).length / allCounts.length) * 100;
                percentileHtml += `
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                            <strong>${rot}</strong>
                            <span>${Math.round(percentile)}th percentile</span>
                        </div>
                        <div class="percentile-bar">
                            <div class="percentile-fill" style="width: ${percentile}%"></div>
                        </div>
                    </div>
                `;
            });
            percentileHtml += '</div>';
            document.getElementById('deepdive-percentile').innerHTML = percentileHtml;
        }

        function buildWeeklyStaffing() {
            const data = getData();
            const coverage = data.coverage;
            const targets = getTargets();
            const rotations = getRotations();

            const z = rotations.map(rot => coverage[rot] || Array(48).fill(0));
            const trace = {
                z: z,
                x: Array.from({length: 48}, (_, i) => `W${i + 1}`),
                y: rotations,
                type: 'heatmap',
                colorscale: 'Blues',
                hoverongaps: false
            };

            const layout = {
                title: 'Weekly Coverage Heatmap (All Rotations  48 Weeks)',
                height: 500,
                xaxis: { title: 'Week' },
                yaxis: { title: 'Rotation' }
            };

            Plotly.newPlot('staffing-heatmap', [trace], layout, { responsive: true });

            if (currentLevel === 'intern') {
                const rotatorCov = data.rotator_coverage || {};
                const sluhCov = coverage.SLUH || Array(48).fill(0);
                const sluhRotators = rotatorCov.SLUH || Array(48).fill(0);

                const traceResident = {
                    x: Array.from({length: 48}, (_, i) => `W${i + 1}`),
                    y: Array.from({length: 48}, (_, i) => sluhCov[i] - sluhRotators[i]),
                    name: 'SLUH Residents',
                    type: 'bar',
                    marker: { color: '#3b82f6' }
                };

                const traceRotators = {
                    x: Array.from({length: 48}, (_, i) => `W${i + 1}`),
                    y: sluhRotators,
                    name: 'SLUH Rotators',
                    type: 'bar',
                    marker: { color: '#93c5fd' }
                };

                const layoutBar = {
                    title: 'SLUH vs VA Staffing: Residents + Rotators',
                    barmode: 'stack',
                    height: 400
                };

                Plotly.newPlot('staffing-stackbar', [traceResident, traceRotators], layoutBar, { responsive: true });
                document.getElementById('staffing-stackbar').style.display = 'block';
            }

            let tableHtml = '<div style="padding: 1rem;"><div class="chart-title">Coverage by Week and Rotation</div>';
            tableHtml += '<table class="staffing-table"><thead><tr><th>Rotation</th><th>Target</th>';
            for (let w = 1; w <= 48; w++) tableHtml += `<th>W${w}</th>`;
            tableHtml += '</tr></thead><tbody>';

            rotations.forEach(rot => {
                const target = targets[rot] || 0;
                const covArray = coverage[rot] || Array(48).fill(0);
                tableHtml += `<tr><td>${rot}</td><td>${target}</td>`;
                covArray.forEach(cov => {
                    const cellClass = cov >= target ? 'meets-target' : 'below-target';
                    tableHtml += `<td class="${cellClass}">${cov}</td>`;
                });
                tableHtml += '</tr>';
            });

            tableHtml += '</tbody></table></div>';
            document.getElementById('staffing-table-container').innerHTML = tableHtml;
        }

        function buildBalance() {
            const data = getData();
            const residents = data.residents;
            const rotations = getRotations();

            const ipValues = residents.map(r => r.ip || 0);
            const traceIp = {
                x: ipValues,
                type: 'histogram',
                nbinsx: 10,
                marker: { color: '#3b82f6' }
            };

            const layoutHist = {
                title: 'IP Weeks Distribution Across Residents',
                xaxis: { title: 'IP Weeks' },
                yaxis: { title: 'Number of Residents' },
                height: 400
            };

            Plotly.newPlot('fairness-histogram', [traceIp], layoutHist, { responsive: true });

            const boxTraces = rotations.map(rot => ({
                y: residents.map(r => r.counts[rot] || 0),
                name: rot,
                type: 'box'
            }));

            const layoutBox = {
                title: 'Distribution of Rotation Weeks by Type',
                yaxis: { title: 'Weeks' },
                height: 500,
                showlegend: false
            };

            Plotly.newPlot('fairness-boxplot', boxTraces, layoutBox, { responsive: true });

            const outliers = findOutliers(residents, rotations);
            let outlierHtml = '<div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 1rem;">';
            outlierHtml += '<div class="chart-title">Outlier Analysis (>1.5 SD from Mean)</div>';

            if (outliers.length > 0) {
                outlierHtml += '<table class="comparison-table"><thead><tr><th>Resident</th><th>Rotation</th><th>Value</th><th>Mean</th><th>SD</th><th>Status</th></tr></thead><tbody>';
                outliers.forEach(out => {
                    outlierHtml += `
                        <tr>
                            <td><strong>${out.resident}</strong></td>
                            <td>${out.rotation}</td>
                            <td><strong>${out.value}</strong></td>
                            <td>${out.mean.toFixed(2)}</td>
                            <td>${out.sd.toFixed(2)}</td>
                            <td><span class="outlier-badge ${out.value > out.mean ? 'high' : ''}">${out.value > out.mean ? 'High' : 'Low'}</span></td>
                        </tr>
                    `;
                });
                outlierHtml += '</tbody></table>';
            } else {
                outlierHtml += '<p style="color: #6b7280; font-style: italic;">No outliers detected.</p>';
            }
            outlierHtml += '</div>';
            document.getElementById('fairness-outliers').innerHTML = outlierHtml;
        }

        function findOutliers(residents, rotations) {
            const outliers = [];
            rotations.forEach(rot => {
                const values = residents.map(r => r.counts[rot] || 0);
                const mean = values.reduce((a, b) => a + b) / values.length;
                const variance = values.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / values.length;
                const sd = Math.sqrt(variance);

                residents.forEach((resident, idx) => {
                    const val = resident.counts[rot] || 0;
                    if (Math.abs(val - mean) > 1.5 * sd) {
                        outliers.push({
                            resident: resident.id,
                            rotation: rot,
                            value: val,
                            mean,
                            sd
                        });
                    }
                });
            });
            return outliers;
        }

        document.addEventListener('DOMContentLoaded', () => {
            buildScheduleGrid();
            buildDeepDive();
        });
    </script>
</body>
</html>
